define(['jquery'],function(a){'use strict';return class{constructor(c){this.dataObjConfig={header:a(c.header).first(),popup:a(c.socialLoginPopup).first(),socialLoad:'social-login-load',error:'error-msg',success:'success-msg',socialLoginForm:a(c.authentication).first(),socialLoginFormContent:a(c.authenticationContent).first(),socialFormLogin:a(c.socialFormLogin),btnAuthentication:a(c.btnAuthentication).first(),btnCreate:a(c.btnCreate).first(),btnRemind:a(c.btnRemind).first(),formLoginUrl:c.formLoginUrl,socialLoginCreate:a(c.socialLoginCreate).first(),socialLoginCreateContent:a(c.socialLoginCreateContent).first(),socialFormCreate:a(c.socialFormCreate),btnSocialFormCreate:a(c.btnSocialFormCreate).first(),btnSocialFormCreateBack:a(c.btnSocialFormCreateBack).first(),socialFormCreateUrl:c.socialFormCreateUrl,socialLoginForgot:a(c.socialLoginForgot).first(),socialLoginForgotContent:a(c.socialLoginForgotContent).first(),socialFormPassword:a(c.socialFormPassword),btnSendForget:a(c.btnSendForget).first(),btnbackForget:a(c.btnbackForget).first(),forgotFormUrl:c.forgotFormUrl},this.init(c)}init(c){a(document).ready(function(){this.dataObjConfig.header&&this.dataObjConfig.header.find('a').each(function(d,f){a(f).click(function(g){var h=g.target;this.currentForm=h.hasClassName('create')?'create':'login','login'==this.currentForm?(this.showLogin(),this.disableCreateForm(),this.disableForgot()):'create'==this.currentForm&&(this.dataObjConfig.socialLoginForm.hide(),this.enableCreate(),this.disableForgot())}.bind(this))}.bind(this))}.bind(this)),a(document).keypress(function(){var f=event.keyCode||event.which;13==f&&('login'==this.currentForm?this.login():'create'==this.currentForm?this.create():'forgot'==this.currentForm&&this.forgot())}.bind(this)),this.dataObjConfig.btnAuthentication.click(function(){this.login()}.bind(this)),this.dataObjConfig.btnSocialFormCreateBack.click(function(){this.currentForm='login',this.disableCreateForm(),this.showLogin()}.bind(this)),this.dataObjConfig.btnSendForget.click(function(){this.forgot()}.bind(this)),this.dataObjConfig.btnbackForget.click(function(){this.currentForm='login',this.disableForgot(),this.showLogin()}.bind(this)),this.dataObjConfig.header&&this.dataObjConfig.header.find('a').each(function(d,f){console.log(a(f).attr('href').includes('/customer/account/login/')),f&&((a(f).attr('href').includes('/customer/account/login/')||a(f).attr('href').includes('/wishlist/')||a(f).attr('href').includes('/customer/account/'))&&(a(f).addClass('social-login'),console.log(a(f)),a(f).attr('href').includes('/customer/account/create')&&a(f).addClass('create'),console.log(this.dataObjConfig),a(f).attr('href',c.socialLoginPopup)),this.currentForm='login',f.setAttribute('data-effect',c.popupEffect))}.bind(this)),this.dataObjConfig.btnCreate.click(function(){this.currentForm='create',this.disableLogin(),this.enableCreate()}.bind(this)),this.dataObjConfig.btnRemind.click(function(){this.currentForm='forgot',this.disableLogin(),this.enableForgot()}.bind(this)),this.dataObjConfig.btnSocialFormCreate.click(function(){this.create()}.bind(this))}showLoadElement(c){a('<div class='+this.dataObjConfig.socialLoad+'></div>').insertBefore(c)}removeLoading(c){var d='.'+this.dataObjConfig.socialLoad;c.css('position',''),a('#social-login-popup').find(d).each(function(f,g){g.remove()})}create(){if(this.dataObjConfig.socialFormCreate.valid()){this.showLoadElement(this.dataObjConfig.socialLoginCreateContent),this.hideMessage(this.dataObjConfig.socialLoginCreateContent,this.dataObjConfig.error);var c=this.dataObjConfig.socialFormCreate.serialize(!0),d=this.dataObjConfig,f=this;a.ajax({url:this.dataObjConfig.socialFormCreateUrl,type:'POST',data:c,success:function(g,h,i){var j=i.responseText.evalJSON();j.success?(f.showMessage(d.socialLoginCreateContent,j.message,d.success),location.reload(!0)):(f.removeLoading(d.socialLoginCreateContent),f.showMessage(d.socialLoginCreateContent,j.message,d.error))}})}}enableCreate(){this.dataObjConfig.socialLoginCreate.show()}disableCreateForm(){this.dataObjConfig.socialLoginCreate.hide()}showLogin(){this.dataObjConfig.socialLoginForm.show()}disableLogin(){this.dataObjConfig.socialLoginForm.hide()}forgot(){if(this.dataObjConfig.socialFormPassword.valid()){this.showLoadElement(this.dataObjConfig.socialLoginForgotContent),this.hideMessage(this.dataObjConfig.socialLoginForgotContent,this.dataObjConfig.error),this.hideMessage(this.dataObjConfig.socialLoginForgotContent,this.dataObjConfig.success);var c=this.dataObjConfig.socialFormPassword.serialize(!0),d=this.dataObjConfig,f=this;a.ajax({url:this.dataObjConfig.forgotFormUrl,type:'POST',data:c,success:function(g,h,i){f.removeLoading(d.socialLoginForgotContent);var j=i.responseText.evalJSON();j.success?f.showMessage(d.socialLoginForgotContent,j.message,d.success):f.showMessage(d.socialLoginForgotContent,j.message,d.error)}})}}enableForgot(){this.dataObjConfig.socialLoginForgot.show()}disableForgot(){this.dataObjConfig.socialLoginForgot.hide()}hideMessage(c,d){a('#social-login-popup').find('.'+d).each(function(f,g){console.log(g),g.remove()})}showMessage(c,d,f){'object'==typeof d&&0<d.length?d.each(function(g){this.appendMsg(c,g,f)}.bind(this)):'string'==typeof d&&this.appendMsg(c,d,f)}appendMsg(c,d,f){console.log(c);var h=c.find('.'+f+' ol');0===h.length&&a('<div class='+f+'><ol></ol></div>').insertBefore(c.find('.block-content').first()),a('#social-login-popup .'+f+' ol').append('<li>'+d+'</li>')}login(){if(this.dataObjConfig.socialFormLogin.valid()){this.showLoadElement(this.dataObjConfig.socialLoginFormContent),this.hideMessage(this.dataObjConfig.socialLoginFormContent,this.dataObjConfig.error);var c=this.dataObjConfig.socialFormLogin.serialize(!0),d=this.dataObjConfig,f=this;a.ajax({url:this.dataObjConfig.formLoginUrl,type:'POST',data:c,success:function(g,h,i){var j=i.responseText.evalJSON();j.success?(f.showMessage(d.socialLoginFormContent,j.message,d.success),window.location.reload(!0)):(f.removeLoading(d.socialLoginFormContent),f.showMessage(d.socialLoginFormContent,j.message,d.error))}})}}}});